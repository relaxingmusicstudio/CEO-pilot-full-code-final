{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ValueAnchor",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "anchorId",
    "version",
    "createdAt",
    "coreObjectives",
    "doNotOptimize",
    "escalationThresholds",
    "reviewCadence"
  ],
  "properties": {
    "anchorId": { "type": "string", "minLength": 1 },
    "version": { "type": "string", "minLength": 1 },
    "createdAt": { "type": "string", "format": "date-time" },
    "coreObjectives": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["objectiveId", "rank", "description"],
        "properties": {
          "objectiveId": { "type": "string", "minLength": 1 },
          "rank": { "type": "integer", "minimum": 0 },
          "description": { "type": "string", "minLength": 1 }
        }
      }
    },
    "doNotOptimize": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["constraintId", "description", "rationale"],
        "properties": {
          "constraintId": { "type": "string", "minLength": 1 },
          "description": { "type": "string", "minLength": 1 },
          "rationale": { "type": "string", "minLength": 1 }
        }
      }
    },
    "escalationThresholds": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "decisionDistribution",
        "routingDistribution",
        "outcomeFailureDelta",
        "rollbackRateDelta",
        "constraintViolationRate",
        "nearMissRate"
      ],
      "properties": {
        "decisionDistribution": { "type": "number", "minimum": 0, "maximum": 1 },
        "routingDistribution": { "type": "number", "minimum": 0, "maximum": 1 },
        "outcomeFailureDelta": { "type": "number", "minimum": 0, "maximum": 1 },
        "rollbackRateDelta": { "type": "number", "minimum": 0, "maximum": 1 },
        "constraintViolationRate": { "type": "number", "minimum": 0, "maximum": 1 },
        "nearMissRate": { "type": "number", "minimum": 0, "maximum": 1 }
      }
    },
    "reviewCadence": { "type": "string", "minLength": 1 }
  }
}
